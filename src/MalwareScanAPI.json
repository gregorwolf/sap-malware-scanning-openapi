{
  "openapi": "3.0.1",
  "info": {
    "title": "SAP Malware Scanning Service",
    "description": "Use SAP Malware Scanning service to scan business documents for malware.",
    "version": "1.0"
  },
  "servers": [
    {
      "url": "https://sandbox.api.sap.com/malwarescanning"
    }
  ],
  "security": [
    {
      "basic_auth": []
    }
  ],
  "paths": {
    "/scan": {
      "post": {
        "summary": "Scans a file for malware.",
        "description": "Use to scan unstructured data on upload. We recommend scanning on download if more than 3 days have passed since upload.",
        "requestBody": {
          "description": "The request body must be plain file binaries.",
          "content": {
            "application/octet-stream": {
              "schema": {
                "type": "string",
                "format": "binary",
                "example": "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*"
              }
            }
          },
          "required": false
        },
        "responses": {
          "200": {
            "description": "OK - Scan complete.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScanResult"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Access denied. Your authentication credentials have been refused.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReturnMessage"
                }
              }
            }
          },
          "413": {
            "description": "Payload too large - The file is too large and cannot be scanned or the archive structure is too complex.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReturnMessage"
                }
              }
            }
          },
          "415": {
            "description": "Unsupported media type - The scanner only accepts plain binary file content as HTTP body and not as form data.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReturnMessage"
                }
              }
            }
          },
          "429": {
            "description": "Too many requests - Too many requests from this subaccount.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReturnMessage"
                }
              }
            }
          },
          "503": {
            "description": "Service unavailable - The scanner is busy.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReturnMessage"
                }
              }
            }
          }
        },
        "security": [
          {
            "basic_auth": []
          }
        ],
        "x-codegen-request-body-name": "fileContent"
      }
    },
    "/info": {
      "get": {
        "summary": "Returns information about the scan engine.",
        "description": "Returns the name and version of the scan engine, the age of the malware signatures, and any file size limitations.",
        "responses": {
          "200": {
            "description": "OK - The API returned consumer relevant information about the service instance.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Status"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Access denied. Your authentication credentials have been refused.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReturnMessage"
                }
              }
            }
          }
        },
        "security": [
          {
            "basic_auth": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "ScanResult": {
        "required": [
          "SHA256",
          "encryptedContentDetected",
          "malwareDetected",
          "scanSize"
        ],
        "type": "object",
        "properties": {
          "malwareDetected": {
            "type": "boolean",
            "description": "Indicates whether the scan engine detected a threat."
          },
          "encryptedContentDetected": {
            "type": "boolean",
            "description": "Indicates whether the file has encrypted parts, which could not be scanned."
          },
          "scanSize": {
            "type": "integer",
            "description": "Size in bytes of the scanned file. Use the file size to validate the success of data transmission."
          },
          "finding": {
            "type": "string",
            "description": "This field may contain information about detected malware."
          },
          "mimeType": {
            "type": "string",
            "description": "Indicates the detected MIME type for the scanned file. This data may not be reliable and results may vary on different service providers."
          },
          "SHA256": {
            "type": "string",
            "description": "SHA-256 hash of the scanned file. Use the hash to validate the success of data transmission."
          }
        }
      },
      "ReturnMessage": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "Provides a description of the return code."
          }
        }
      },
      "Status": {
        "required": [
          "maxScanSize"
        ],
        "type": "object",
        "properties": {
          "maxScanSize": {
            "type": "integer",
            "description": "Max file size in bytes, accepted by this service instance."
          },
          "signatureTimestamp": {
            "type": "string",
            "description": "Time of the last malware definition update. UTC timestamp is in ISO 8601 format."
          },
          "engineVersion": {
            "type": "string",
            "description": "Version of the scan engine."
          }
        }
      }
    },
    "securitySchemes": {
      "basic_auth": {
        "type": "http",
        "description": "Credentials are created with the service binding.",
        "scheme": "basic"
      }
    }
  },
  "x-sap-api-type": "REST",
  "x-sap-shortText": "Scan business documents uploaded by your custom-developed applications for malware.",
  "x-sap-stateInfo": {
    "state": "Active"
  },
  "x-servers": [
    {
      "url": "https://malware-scanner.cf.{Landscape}.hana.ondemand.com",
      "description": "REST API endpoint for the malware scanning API of the SAP Malware Scanning service.",
      "templates": {
        "Landscape": {
          "description": "Region host."
        }
      }
    }
  ]
}
